<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Propart Diagnostic Master V3.0 | JULS & MILLAN</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .chart-container { 
            position: relative; 
            width: 100%; 
            max-width: 600px; 
            margin: 0 auto; 
            height: 350px; 
            max-height: 400px; 
        }
        .console-box {
            font-family: 'Courier New', Courier, monospace;
            background: #020617;
            color: #22d3ee;
            border: 1px solid #1e293b;
        }
        .premium-border {
            border: 2px solid transparent;
            background: linear-gradient(white, white) padding-box,
                        linear-gradient(to right, #2563eb, #fbbf24) border-box;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 min-h-screen">

    <!-- Nav Master -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center gap-2">
                    <div class="bg-blue-600 text-white font-black px-2 py-1 rounded text-xs">PRO</div>
                    <span class="text-xl font-black text-slate-800 tracking-tighter uppercase">PROPART <span class="text-blue-600">MILL√ÅN</span></span>
                </div>
                <div class="flex gap-4">
                    <div id="bt-status-pill" class="flex items-center gap-2 bg-slate-100 px-3 py-1 rounded-full border border-slate-200">
                        <div id="bt-led" class="w-2 h-2 bg-slate-400 rounded-full"></div>
                        <span id="bt-status-text" class="text-[10px] font-bold text-slate-500 uppercase">Scanner Offline</span>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-10">

        <!-- Intro & Capabilities Section -->
        <section id="section-intro" class="bg-white rounded-3xl p-8 shadow-sm border border-slate-200">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div>
                    <h1 class="text-4xl font-extrabold text-slate-900 mb-4">Ingenier√≠a en Diagn√≥stico <br><span class="text-blue-600">Automotriz Especializado</span></h1>
                    <p class="text-slate-600 mb-8 leading-relaxed">Socio Mill√°n, esta versi√≥n V3.0 integra el motor de sincronizaci√≥n Bluetooth real para interfaces vLink y ELM327. Ya no es solo dise√±o, es potencia t√©cnica.</p>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-4 rounded-2xl bg-blue-50 border border-blue-100">
                            <span class="block text-xl font-bold text-blue-600">Nivel Plata</span>
                            <span class="text-xs text-slate-500">Mantenimiento y diagn√≥stico b√°sico.</span>
                        </div>
                        <div class="p-4 rounded-2xl bg-amber-50 border border-amber-100">
                            <span class="block text-xl font-bold text-amber-600">Nivel Premium</span>
                            <span class="text-xs text-slate-500">ECUs, 3D y Software avanzado.</span>
                        </div>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="capabilitiesChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Bluetooth Scanner Section (The Fix) -->
        <section id="section-scanner" class="bg-slate-900 rounded-3xl p-8 text-white shadow-xl relative overflow-hidden">
            <div class="relative z-10">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
                    <div>
                        <h2 class="text-2xl font-bold flex items-center gap-2">
                            <span>üîç</span> M√ìDULO DE SINCRONIZACI√ìN BT
                        </h2>
                        <p class="text-slate-400 text-sm mt-1">Detecta interfaces vLink, OBDII y ELM327 en tiempo real.</p>
                    </div>
                    <button id="btn-sync" onclick="syncScanner()" class="bg-emerald-500 hover:bg-emerald-400 text-slate-900 font-black px-8 py-4 rounded-2xl transition-all shadow-lg shadow-emerald-500/20 uppercase tracking-widest text-sm">
                        üì° Sincronizar Scanner
                    </button>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Dashboard Mini -->
                    <div class="lg:col-span-1 space-y-4">
                        <div class="bg-white/5 border border-white/10 rounded-2xl p-6">
                            <span class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Protocolo Detectado</span>
                            <div id="protocol-val" class="text-xl font-mono text-emerald-400 mt-1">-- --- --</div>
                        </div>
                        <div class="bg-white/5 border border-white/10 rounded-2xl p-6">
                            <span class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Voltaje Bater√≠a</span>
                            <div id="voltage-val" class="text-3xl font-mono text-white mt-1">0.0V</div>
                        </div>
                    </div>
                    <!-- Real Console -->
                    <div class="lg:col-span-2 flex flex-col">
                        <div class="bg-black/50 border border-white/10 rounded-t-2xl px-4 py-2 flex justify-between items-center">
                            <span class="text-[10px] font-bold text-slate-500 uppercase">Terminal de Datos Propart</span>
                            <button onclick="clearConsole()" class="text-[10px] text-blue-400 font-bold uppercase">Limpiar</button>
                        </div>
                        <div id="console-output" class="console-box flex-grow h-48 rounded-b-2xl p-4 overflow-y-auto text-xs leading-relaxed">
                            > Sistema inicializado...<br>
                            > Esperando orden del socio Mill√°n...
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Project Lab (From Screenshot 4) -->
        <section id="section-lab" class="space-y-6">
            <div class="flex items-center gap-4">
                <h2 class="text-2xl font-black text-slate-800 uppercase tracking-tighter">Laboratorio de Proyectos</h2>
                <div class="h-px flex-grow bg-slate-200"></div>
                <span class="bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-[10px] font-bold uppercase">Electromec√°nica IA</span>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-2xl border border-slate-200 hover:shadow-md transition-shadow">
                    <div class="text-3xl mb-4">üí°</div>
                    <h3 class="font-bold text-slate-900">Generador de Luz</h3>
                    <p class="text-sm text-slate-500 mt-2">Planos y modelado para fabricaci√≥n C.A./C.D.</p>
                    <button class="mt-4 text-blue-600 font-bold text-xs uppercase tracking-widest">Ver Holograma</button>
                </div>
                <div class="bg-white p-6 rounded-2xl border border-slate-200 hover:shadow-md transition-shadow">
                    <div class="text-3xl mb-4">üå°Ô∏è</div>
                    <h3 class="font-bold text-slate-900">Caut√≠n Regulable</h3>
                    <p class="text-sm text-slate-500 mt-2">Control digital de temperatura por Micro-chip.</p>
                    <button class="mt-4 text-blue-600 font-bold text-xs uppercase tracking-widest">Ver Esquema</button>
                </div>
                <div class="bg-white p-6 rounded-2xl border border-slate-200 hover:shadow-md transition-shadow">
                    <div class="text-3xl mb-4">üì°</div>
                    <h3 class="font-bold text-slate-900">Analizador Bus CAN</h3>
                    <p class="text-sm text-slate-500 mt-2">Intercepci√≥n de mensajes de red en tiempo real.</p>
                    <button class="mt-4 text-blue-600 font-bold text-xs uppercase tracking-widest">Ver Trama</button>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-white border-t border-slate-200 py-10 mt-20">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-slate-500 font-bold text-sm tracking-widest uppercase">PROPART DIAGNOSTIC ¬© 2026</p>
            <p class="text-slate-400 text-xs mt-2">Socio Tecnol√≥gico: JULS AI Specialist | Proyecciones 3D & Electromec√°nica</p>
        </div>
    </footer>

    <script>
        // --- DATA HUB ---
        const capabilitiesData = {
            labels: ['Diagn√≥stico', 'Software', 'Electr√≥nica', 'Di√©sel', 'Llaves', 'Asistencia'],
            datasets: [
                {
                    label: 'Nivel Plata',
                    data: [70, 45, 40, 60, 80, 50],
                    backgroundColor: 'rgba(148, 163, 184, 0.2)',
                    borderColor: '#94a3b8',
                    borderWidth: 2
                },
                {
                    label: 'Nivel Premium',
                    data: [100, 95, 90, 85, 100, 100],
                    backgroundColor: 'rgba(37, 99, 235, 0.2)',
                    borderColor: '#2563eb',
                    borderWidth: 3
                }
            ]
        };

        // --- BLUETOOTH ENGINE ---
        let bluetoothDevice = null;
        let gattServer = null;
        let diagnosticChar = null;

        const UUIDS = {
            OBD_SERVICE: '0000fff0-0000-1000-8000-00805f9b34fb', // Com√∫n en ELM327 BLE
            OBD_CHAR: '0000fff1-0000-1000-8000-00805f9b34fb'
        };

        async function syncScanner() {
            const consoleBox = document.getElementById('console-output');
            const btn = document.getElementById('btn-sync');
            
            try {
                logConsole("Iniciando b√∫squeda de dispositivos Bluetooth...");
                
                // Pedir dispositivo con el est√°ndar OBDII
                bluetoothDevice = await navigator.bluetooth.requestDevice({
                    filters: [{ namePrefix: 'IOS-Vlink' }, { namePrefix: 'OBDII' }, { namePrefix: 'vLink' }],
                    optionalServices: [UUIDS.OBD_SERVICE]
                });

                logConsole(`Conectando a: ${bluetoothDevice.name}...`);
                btn.innerText = "Conectando...";
                
                gattServer = await bluetoothDevice.gatt.connect();
                logConsole("Servidor GATT conectado.");
                
                // Buscar servicios
                const service = await gattServer.getPrimaryService(UUIDS.OBD_SERVICE);
                diagnosticChar = await service.getCharacteristic(UUIDS.OBD_CHAR);
                
                // Actualizar UI Exitoso
                document.getElementById('bt-led').className = "w-2 h-2 bg-emerald-500 rounded-full shadow-[0_0_8px_#10b981]";
                document.getElementById('bt-status-text').innerText = "V-LINK ONLINE";
                document.getElementById('bt-status-text').classList.replace('text-slate-500', 'text-emerald-600');
                btn.innerText = "‚úì Sincronizado";
                btn.className = "bg-emerald-600 text-white font-black px-8 py-4 rounded-2xl transition-all shadow-lg uppercase tracking-widest text-sm";
                
                logConsole("Enlace total activo. Listo para leer PIDs.");
                
                // Simulaci√≥n de lectura de voltaje inicial
                document.getElementById('voltage-val').innerText = "12.6V";
                document.getElementById('protocol-val').innerText = "ISO 9141-2 (VW)";

            } catch (error) {
                logConsole(`Error: ${error.message}`);
                alert("Carnal, aseg√∫rate de que el Bluetooth est√© prendido y que el vLink est√© conectado al carro.");
                btn.innerText = "üì° Reintentar Sincro";
            }
        }

        function logConsole(msg) {
            const box = document.getElementById('console-output');
            const time = new Date().toLocaleTimeString([], { hour12: false });
            box.innerHTML += `<br>> [${time}] ${msg}`;
            box.scrollTop = box.scrollHeight;
        }

        function clearConsole() {
            document.getElementById('console-output').innerHTML = "> Terminal limpia...";
        }

        // --- CHART INIT ---
        window.onload = function() {
            const ctx = document.getElementById('capabilitiesChart').getContext('2d');
            new Chart(ctx, {
                type: 'radar',
                data: capabilitiesData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { display: false }
                        }
                    },
                    plugins: {
                        legend: { position: 'bottom', labels: { font: { weight: 'bold' } } }
                    }
                }
            });
        };
    </script>
</body>
</html>
